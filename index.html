<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Carta Interactiva</title>

  <style>
    :root{
      --bg0:#07070b;
      --bg1:#0b0b14;
      --ink:#f5f2ea;
      --muted: rgba(245,242,234,.72);
      --card: rgba(255,255,255,.06);
      --stroke: rgba(255,255,255,.12);
      --shadow: 0 24px 90px rgba(0,0,0,.55);
      --accent:#ff3d8d;
      --accent2:#49d7ff;
      --good:#37f2a6;
      --warn:#ffcc66;
      --radius: 26px;
    }

    *{ box-sizing:border-box }
    html,body{ height:100%; margin:0; padding:0; }
    body{
      background:
        radial-gradient(1100px 700px at 18% 18%, rgba(255,61,141,.16), transparent 60%),
        radial-gradient(900px 650px at 82% 22%, rgba(73,215,255,.14), transparent 60%),
        radial-gradient(800px 700px at 50% 105%, rgba(55,242,166,.10), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      color: var(--ink);
      font-family: "Plus Jakarta Sans", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 20px;
      overflow-x: hidden;
    }

    .container {
      background: var(--card);
      border-radius: var(--radius);
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      max-width: 480px;
      width: 100%;
      padding: 24px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }

    h1 {
      font-family: "Fraunces", serif;
      font-weight: 700;
      font-size: 2.4rem;
      margin: 0;
      text-align: center;
      color: var(--accent);
      user-select: none;
    }

    .frame {
      width: 100%;
      aspect-ratio: 4 / 3;
      border-radius: 28px;
      background:
        radial-gradient(18px 18px at 18% 22%, rgba(255,255,255,.18), transparent 60%),
        radial-gradient(22px 22px at 80% 28%, rgba(255,61,141,.16), transparent 60%),
        radial-gradient(30px 30px at 54% 84%, rgba(73,215,255,.14), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: 0 28px 90px rgba(0,0,0,.55);
      position: relative;
      overflow: hidden;
      cursor: pointer;
      display: grid;
      place-items: center;
    }

    .frame img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      border-radius: 22px;
      user-select: none;
      pointer-events: none;
    }

    .letter-text {
      margin-top: 16px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.15);
      border-radius: 22px;
      padding: 20px 28px;
      box-shadow: 0 18px 60px rgba(0,0,0,.35);
      font-family: "Fraunces", serif;
      font-size: 1.1rem;
      line-height: 1.6;
      color: var(--ink);
      max-width: 100%;
      text-align: center;
      user-select: text;
      display: none;
      white-space: pre-wrap;
    }

    .controls {
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
    }

    button {
      background: var(--accent);
      border: none;
      border-radius: 14px;
      padding: 10px 18px;
      color: white;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      box-shadow: 0 12px 40px rgba(255,61,141,.3);
      transition: background-color 0.3s ease;
      user-select: none;
    }
    button:hover {
      background: #ff5aab;
    }
    button:active {
      transform: scale(0.97);
    }

    @media (max-width: 520px) {
      .container {
        max-width: 100%;
        padding: 16px;
      }
      h1 {
        font-size: 1.8rem;
      }
      .letter-text {
        font-size: 1rem;
        padding: 16px 20px;
      }
    }
  </style>
</head>
<body>

  <div class="container" role="main" aria-label="Carta interactiva">
    <h1>Tu carta especial</h1>

    <div class="frame" id="frame" tabindex="0" aria-live="polite" aria-label="Carta interactiva. Haz clic para abrir y cerrar">
      <img id="cardImage" src="carta-cerrada.gif" alt="Carta cerrada" />
    </div>

    <div class="letter-text" id="letterText" aria-live="polite" aria-atomic="true">
      <!-- Aquí va tu texto -->
      Querida persona especial,

      Solo quería decirte que cada momento contigo es un regalo que atesoro profundamente. Espero que esta carta te haga sonreír y recuerdes cuánto te aprecio.

      Con todo mi cariño,
      Tu nombre
    </div>

    <div class="controls" role="group" aria-label="Controles de la carta">
      <button id="prevBtn" aria-label="Estado anterior">Anterior</button>
      <button id="nextBtn" aria-label="Siguiente estado">Siguiente</button>
      <button id="resetBtn" aria-label="Reiniciar carta">Reiniciar</button>
    </div>
  </div>

  <script>
    const STATES = [
      { key: "cerrada", label: "Carta cerrada", file: "carta-cerrada.gif" },
      { key: "abierta", label: "Carta abierta con papel", file: "carta-abierta.gif" },
      { key: "papel", label: "Mostrando el papel", file: "carta-papel.gif" }
    ];

    let idx = 0;
    const cardImage = document.getElementById("cardImage");
    const letterText = document.getElementById("letterText");
    const frame = document.getElementById("frame");
    const nextBtn = document.getElementById("nextBtn");
    const prevBtn = document.getElementById("prevBtn");
    const resetBtn = document.getElementById("resetBtn");

    function updateView() {
      const state = STATES[idx];
      cardImage.src = state.file + "?v=" + Date.now(); // cache bust to replay GIF
      cardImage.alt = state.label;

      // Mostrar texto solo en el último estado
      if (idx === STATES.length - 1) {
        letterText.style.display = "block";
      } else {
        letterText.style.display = "none";
      }
    }

    function next() {
      idx = (idx + 1) % STATES.length;
      updateView();
    }

    function prev() {
      idx = (idx - 1 + STATES.length) % STATES.length;
      updateView();
    }

    function reset() {
      idx = 0;
      updateView();
    }

    // Eventos botones
    nextBtn.addEventListener("click", next);
    prevBtn.addEventListener("click", prev);
    resetBtn.addEventListener("click", reset);

    // Clic en la carta avanza
    frame.addEventListener("click", next);

    // Control con teclado: espacio avanza, flechas navegan, R reinicia
    window.addEventListener("keydown", (e) => {
      if (e.target.tagName === "BUTTON" || e.target.tagName === "INPUT" || e.target.isContentEditable) return;
      switch (e.code) {
        case "Space":
          e.preventDefault();
          next();
          break;
        case "ArrowRight":
          next();
          break;
        case "ArrowLeft":
          prev();
          break;
        case "KeyR":
          reset();
          break;
      }
    });

    // Inicializar vista
    updateView();
  </script>

</body>
</html>
